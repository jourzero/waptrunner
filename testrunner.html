<head>
    <title id="myTitle">WAPT Runner</title>
</head>

<body>
    <!-- PROJECT SUMMARY -->
    <div class="container">
    <details>
        <summary>Project Summary</summary>
        <table class="issueTab">
            <tr><th class="issueTH">Scope</th><td class="issueVals">
                    <select id="ScopeSel" title="Scope" class="scopeSelector" >
                        <option disabled selected>Scope</option>
                        <option class="scopeOpt" value=""                      >All Tests</option>
                        <option class="scopeOpt" value="TSource  : 'WAHH2'"    >WAHH v2</option>
                        <option class="scopeOpt" value="TSource  : 'OWASP-TG4'">OWASP TG4</option>
                        <option class="scopeOpt" value="TTop10   : true"       >Top10</option>
                        <option class="scopeOpt" value="TTop25   : true"       >Top25</option>
                        <option class="scopeOpt" value="TStdTest : true"       >Custom Std</option>
                        <option class="scopeOpt" value="TPCI     : true"       >PCI</option>
                    </select>
                </td></tr>
        </table>
    <!-- ISSUE TABLE -->
        <table class="issueTab">
            <tr><th class="issueTH"></th><td class="issueVals">
                    <table class="issueSummaryTab">
                        <tr class="issueSummaryTR">
                            <th class="isTH"></th>
                            <th class="isTH">Prio</th>
                            <th class="isTH">Issue</th>
                            <th class="isTH">CWE</th>
                            <th class="isTH">TID</th>
                            <th class="isTH">Count</th>
                            <th class="isTH">Sev.</th>
                        </tr>
                                {{#each myIssues}}
                                    {{> myIssueTmpl}}
                                {{/each}}
                    </table>
                </td></tr>
        </table>
    </details>
    <!-- TEST SELECTOR -->
        <table class="issueTab">
            <tr><th class="issueTH">Test</th><td class="issueVals">
                    <table>
                        <tr><td class="tselTD">
                                <button id="btnBack" class="button black">&lt; Back</button>
                            </td>
                            <td class="tselTD">
                                <select id="testSel" title="Test ID" class="testSelector">
                                    <option disabled selected>Test ID</option>
                                    {{#each myTests}}
                                    {{> myTestTmpl}}
                                    {{/each}}
                                </select>
                            </td><td class="tselTD">
                                <button id="btnNext" class="button black">Next &gt;</button>                    
                            </td>
                            <td  id="TPhase"   class="tinyTD"></td>
                            <td  id="TSection" class="tinyTD"></td>
                        </tr>
                    </table></td></tr>
            <!-- <tr><th class="issueTH"></th><td class="issueVals">
            <input id="testNameTA" class="form-control typeahead" name="testnameTA" type="text" placeholder="Search by Test Name" autocomplete="off" spellcheck="false" data-source="testNames" data-open="open" data-close="close" data-select="select" data-autocomplete="autocomplete" data-limit="20" /></td></tr> -->
        </table>

    <!-- CWE SEARCH -->
    <details open="open">
        <summary>Common Weakness Information (CWE)</summary>
        <table class="issueTab">
            <tr class="iTR"><th class="issueTH">CWE Name</th>       <td class="issueVals"><input id="cwename" class="form-control typeahead" name="cwename" type="text" placeholder="Search by CWE Name" autocomplete="off" spellcheck="false" data-source="cwes" data-open="open" data-close="close" data-select="select" data-autocomplete="autocomplete" data-limit="20" /></td></tr>
            <tr class="iTR"><th class="issueTH">CWE ID</th>            <td class="issueVals"><a class="issueA" target="cweTab" id="cweref" href="https://cwe.mitre.org/" title="Ref URI" ></a></td></tr>
        </table>
    </details>

    <!-- TEST SELECTOR -->
    <details open="open">
        <summary>Testing Information (KB)</summary>
        <table class="issueTab">
            <tr class="iTR"><th class="issueTH">Test Name</th>   <td class="issueVals"><input id="TTestName" class="testKbIn" type="text" placeholder="Test Name" /><!-- <button id="kbBtnNew" class="kbBtn" disabled>New Test</button> --></td></tr>
            <tr class="iTR"><th class="issueTH">Test Type</th>  <td class="issueVals"><input id="TType" class="testKbIn" type="text" placeholder="Test Type" /></td></tr> 
            <!-- <tr class="iTH"><th class="issueTH">Test Descr.</th><td class="issueVals"><input id="TDescr" class="testKbIn" type="text" placeholder="Test Description" /></td></tr> -->
            <tr class="iTR"><th class="issueTH">Tester Help</th><td class="issueVals"><textarea id="TTesterSupport" class="testKbTA" rows="2" placeholder="Tester Support"></textarea></td></tr>
            <tr class="iTR"><th class="issueTH">Test Ref</th>   <td class="issueVals"><a href="#" id="TTRefA" target="TRWin">&gt;&gt;&gt;</a> <input id="TTRef" class="testKbIn" type="text" placeholder="Tester Reference URI" /></td></tr> 
        </table>
    </details>

    <!-- GENERIC ISSUE DATA -->
    <details open="open">
        <summary>Generic Issue Data (KB)</summary>
        <table class="issueTab">
            <tr hidden><th class="issueTH">OID</th> <td class="issueVals"><input id="OID" class="testKbIn" type="text" placeholder="OID" /></td></tr>             
            <tr class="iTR"><th class="issueTH">Issue Name</th>  <td class="issueVals"><input id="TIssueName" class="testKbIn" type="text" placeholder="Issue Name" /></td>
                    <th class="issueTH">Issue Type</th>  <td class="issueVals"><input id="TIssueType" class="testKbIn" type="text" placeholder="Issue Type" /></td></tr> 
            <tr class="iTR"><th class="issueTH">Severity</th>   <td class="issueVals">
                <!-- <input id="TSeverity" class="testKbIn" type="text" placeholder="Severity" /> -->
                <select id="TSeverity" title="Priority" class="sevSelector" >
                    <option disabled selected  value="">Severity</option>
                    <option class="selOpt" value="0">Info</option>
                    <option class="selOpt" value="1">Low</option>
                    <option class="selOpt" value="2">Medium</option>
                    <option class="selOpt" value="3">High</option>
                </select></td>
                <th class="issueTH">Standards</th>
                <td class="issueVals"> 
                    <input type="checkbox" id="TPCI"     class="testKbCB" value="PCI">PCI
                    <input type="checkbox" id="TTop10"   class="testKbCB" value="Top10">Top 10
                    <input type="checkbox" id="TTop25"   class="testKbCB" value="Top25">Top 25
                    <input type="checkbox" id="TStdTest" class="testKbCB" value="StdTest">Custom Std</td></tr> 
            <tr class="iTR"><th class="issueTH">Issue Ref1</th> <td class="issueVals"><a href="#" id="TRef1A" target="TRWin">&gt;&gt;&gt;</a> <input id="TRef1" class="testKbInShort" type="text" placeholder="Ref 1" /></td>
                            <th class="issueTH">Issue Ref2</th> <td class="issueVals"><a href="#" id="TRef2A" target="TRWin">&gt;&gt;&gt;</a> <input id="TRef2" class="testKbInShort" type="text" placeholder="Ref 2" /></td></tr> 
        </table>
    </details>    
    
    <!-- SPECIFIC ISSUE DATA -->
    <details open="open">
        <summary>Specific Issue Data</summary>
        <table class="issueTab">        
            <tr class="iTR"><th class="issueTH">URIs</th>       <td class="issueDetails"><textarea id="IURIs"      class="issueTA" rows="3" placeholder="URI List"></textarea></td></tr>
            <tr class="iTR"><th class="issueTH">Evidence</th>   <td class="issueDetails"><textarea id="IEvidence"  class="issueTA" rows="3" placeholder="Evidence"></textarea></td></tr>
            <tr class="iTR"><th class="issueTH">Notes</th>      <td class="issueDetails"><textarea id="INotes"     class="issueTA" rows="3" placeholder="Notes"></textarea></td></tr>
            <tr class="iTR"><th class="issueTH">Priority</th>   <td class="issueDetails">
                <!--<input id="IPriority"     class="testKbInShort" type="text" placeholder="Priority" />-->
                <select id="IPriority" title="Priority" class="prioSelector" >
                    <option disabled selected value="">Priority</option>
                    <option class="prioOpt" value="0">Info</option>
                    <option class="prioOpt" value="1">Low</option>
                    <option class="prioOpt" value="2">Medium</option>
                    <option class="prioOpt" value="3">High</option>
                </select>
            </td></tr> 

        </table>
    </details>
        
    </div>
</body>
        

<template name="myTestTmpl">
    <option class="testOpt" value="{{TID}}" oid="{{OID}}" tSource="{{TSource}}">{{TID}}</option>
</template>

<template name="myIssueTmpl">
    <tr class="{{IPriorityText}}Priority">
        <td class="isTD"><button class="delete">&times;</button></td>
        <td class="isTD">{{IPriority}}-{{IPriorityText}}</td>
        <td class="isTD">{{TIssueName}}</td>
        <td class="isTD">{{CweId}}</td>
        <td class="isTD">{{TID}}</td>
        <td class="isTD">{{ICount}}</td>
        <td class="isTD">{{TSeverity}}-{{TSeverityText}}</td>
    </tr>
</template>

