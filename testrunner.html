<head>
    <title id="myTitle">WAPT Runner</title>
</head>

<body>
    <!-- PROJECT SUMMARY -->
    <div class="container">
    <details id="prjDetails" open="open">
        <summary>Project Summary</summary>
        <table class="issueTab">
            <tr><th class="issueTH">Name</th>
                <td class="issueVals">
                    <input list="prjs" id="PrjName" class="prjIn" placeholder="YYYYMMDD-ENV-APP" />
                    <datalist id="prjs">
                        {{#each projects}}
                            {{> projectTmpl}}
                        {{/each}}                        
                   </datalist>
                </td>
            </tr>
            <tr><th class="issueTH">Scope</th><td class="issueVals">
                    <select id="ScopeSel" title="Scope" class="scopeSelector">
                        <option disabled selected>Scope</option>
                        <option class="scopeOpt" title="ALL" value=""                       >All Tests</option>
                        <option class="scopeOpt" title="EXT" value="TPhase: 'Extras'"       >Extras</option>
                        <option class="scopeOpt" title="TG4" value="TSource: 'OWASP-TG4'"   >OWASP TG4</option>
                        <option class="scopeOpt" title="PCI" value="TPCI: true"             >PCI</option>
                        <option class="scopeOpt" title="STD" value="TStdTest: true"         >Standard</option>
                        <option class="scopeOpt" title="T10" value="TTop10: true"           >Top 10</option>
                        <option class="scopeOpt" title="T25" value="TTop25: true"           >Top 25</option>
                        <option class="scopeOpt" title="WAH" value="TSource: 'SEC542'"      >SEC542</option>
                        <option class="scopeOpt" title="WAH" value="TSource: 'SEC642'"      >SEC642</option>
                        <option class="scopeOpt" title="WAH" value="TSource: 'WAHH2'"       >WAHH v2</option>
                        <option class="scopeOpt" title="WSV" value="TSource: 'WebSvc'"      >Web Services</option>
                    </select>
                </td></tr>
        </table>
    <!-- ISSUE TABLE -->
        <table class="issueTab">
            <tr><th class="issueTH">Findings</th><td class="issueVals">
                    <table class="issueSummaryTab">
                        <tr class="issueSummaryTR">
                            <th class="isTH" width="25px"></th>
                            <th class="isTH">Priority</th>
                            <th class="isTH">Issue</th>
                            <th class="isTH">CWE</th>
                            <th class="isTH">TID</th>
                            <th class="isTH">Count</th>
                            <th class="isTH">Severity</th>
                        </tr>
                                {{#each myIssues}}
                                    {{> myIssueTmpl}}
                                {{/each}}
                    </table>
                </td></tr>
        </table>
    </details>
    <!-- TEST SELECTOR -->
        <table class="issueTab">
            <tr><th class="issueTH">Test</th><td class="issueVals">
                    <table>
                        <tr><td class="tselTD">
                                <button id="btnBack" class="button black">&lt; Back</button>
                            </td>
                            <td class="tselTD">
                                <select id="testSel" title="Choose Test" class="testSelector">
                                    <option disabled>Choose Test</option>
                                    {{#each myTests}}
                                    {{> myTestTmpl}}
                                    {{/each}}
                                </select>
                            </td><td class="tselTD">
                                <button id="btnNext" class="button black">Next &gt;</button>                    
                            </td>
                            <td  id="TPhase"   class="tinyTD" title="Phase"></td>
                            <td  id="TSection" class="tinyTD" title="Section"></td>
                        </tr>
                    </table></td></tr>
            <tr>
                <th class="issueTH"></th>
                <td class="issueVals">
                    <input id="testNameTA" class="form-control typeahead" name="testNameTA" type="text" placeholder="Search by Test Name" autocomplete="off" spellcheck="false" data-source="myTests" data-open="openTN" data-close="closeTN" data-select="selectTN" data-autocomplete="autocompleteTN" data-limit="20" />
                </td>
            </tr> 
            
        </table>

    <!-- CWE SEARCH -->
    <details open="open" id="cweDetails">
        <summary>Common Weakness Information (CWE)</summary>
        <table class="issueTab">
            <tr class="iTR"><th class="issueTH">Name</th> <td class="issueVals"><input id="cwename" class="form-control typeahead" name="cwename" type="text" placeholder="Search by CWE Name" autocomplete="off" spellcheck="false" data-source="cwes" data-open="open" data-close="close" data-select="select" data-autocomplete="autocomplete" data-limit="20" /></td></tr>
            <tr class="iTR"><th class="issueTH">ID</th>   <td class="issueVals"><a class="issueA" target="cweTab" id="cweref" href="https://cwe.mitre.org/" title="Ref URI" ></a></td></tr>
        </table>
    </details>

    <!-- TEST SELECTOR -->
    <details open="open" id="testingDetails">
        <summary>Testing Information (KB)</summary>
        <table class="issueTab">
            <tr class="iTR"><th class="issueTH">Test Name</th>   <td class="issueVals"><input id="TTestName" class="testKbInShort" type="text" placeholder="Test Name" />
            <button id="kbBtnNew" class="kbBtn" disabled>New</button></td></tr>
            <tr class="iTR"><th class="issueTH">Test Type</th>  <td class="issueVals"><input id="TType" class="testKbIn" type="text" placeholder="Test Type" /></td></tr> 
            <tr class="iTR"><th class="issueTH">Tester Help</th><td class="issueVals"><textarea id="TTesterSupport" class="testKbTA" rows="2" placeholder="Tester Support"></textarea></td></tr>
            <tr class="iTR"><th class="issueTH">Test Ref</th>   <td class="issueVals"><a href="#" id="TTRefA" target="TRWin">&gt;</a> <input id="TTRef" class="testKbIn" type="text" placeholder="Tester Reference URI" /></td></tr> 
        </table>
    </details>

    <!-- GENERIC ISSUE DATA -->
    <details open="open" id="genericDetails">
        <summary>Generic Issue Data (KB)</summary>
        <table class="issueTab">
            <tr hidden>
                <th class="issueTH">OID</th>
                <td class="issueVals"><input id="OID" class="testKbIn" type="text" placeholder="OID" /></td>
            </tr>             
            <tr class="iTR">
                <th class="issueTH">Issue Name</th>  
                <td class="issueVals"><input id="TIssueName" class="testKbIn" type="text" placeholder="Issue Name (short)" /></td>                
                <th class="issueTH">Severity</th>   
                <td class="issueVals">
                    <select id="TSeverity" title="Priority" class="sevSelector" >
                        <option disabled selected  value="">Severity</option>
                        <option class="selOpt" value="0">Info</option>
                        <option class="selOpt" value="1">Low</option>
                        <option class="selOpt" value="2">Medium</option>
                        <option class="selOpt" value="3">High</option>
                    </select></td>
            </tr> 
            <tr class="iTR">
                <th class="issueTH">Issue Type</th>  
                <td class="issueVals"><input id="TIssueType" class="testKbIn" type="text" placeholder="Issue Type" /></td>                
                <th class="issueTH">Issue Ref1</th> <td class="issueVals"><a href="#" id="TRef1A" target="TRWin">&gt;</a> <input id="TRef1" class="testKbInShort" type="text" placeholder="Ref 1" /></td>
            </tr> 
            <tr class="iTR">
                <th class="issueTH">Standards</th>
                <td class="issueVals"> 
                    <input type="checkbox" id="TPCI"     class="testKbCB" value="PCI" title="PCI-DSS Compliance Test">PCI
                    <input type="checkbox" id="TTop10"   class="testKbCB" value="Top10" title="OWASP Top 10 Test">T10
                    <input type="checkbox" id="TTop25"   class="testKbCB" value="Top25" title="SANS Top 25 Most Dangerous Software Errors Tests">T25
                    <input type="checkbox" id="TStdTest" class="testKbCB" value="StdTest" title="My own list of Standard Tests">Std</td>
                <th class="issueTH">Issue Ref2</th> <td class="issueVals"><a href="#" id="TRef2A" target="TRWin">&gt;</a> <input id="TRef2" class="testKbInShort" type="text" placeholder="Ref 2" /></td>
            </tr> 
        </table>
    </details>    
    
    <!-- SPECIFIC ISSUE DATA -->
    <details open="open" id="specificDetails">
        <summary>Specific Issue Data</summary>
        <table class="issueTab">        
            <tr class="iTR"><th class="issueTH">URIs</th>       <td class="issueDetails"><textarea id="IURIs"      class="issueTA" rows="3" placeholder="URI List"></textarea></td></tr>
            <tr class="iTR"><th class="issueTH">Evidence</th>   <td class="issueDetails"><textarea id="IEvidence"  class="issueTA" rows="3" placeholder="Evidence"></textarea></td></tr>
            <tr class="iTR"><th class="issueTH">Notes</th>      <td class="issueDetails"><textarea id="INotes"     class="issueTA" rows="3" placeholder="Notes"></textarea></td></tr>
            <tr class="iTR"><th class="issueTH">Priority</th>   <td class="issueDetails">
                <select id="IPriority" title="Priority" class="prioSelector" >
                    <option disabled selected value="">Priority</option>
                    <option class="prioOpt" value="0">Info</option>
                    <option class="prioOpt" value="1">Low</option>
                    <option class="prioOpt" value="2">Medium</option>
                    <option class="prioOpt" value="3">High</option>
                </select>
            </td></tr> 
        </table>
    </details>
        
    </div>
</body>
        

<template name="myTestTmpl">
    <option class="testOpt" value="{{TID}}" oid="{{OID}}" tSource="{{TSource}}">{{TID}} {{TTestName}}</option>
</template>

<template name="myTestTmpl2">
    <option class="testOpt2">{{TTestName}} ({{TStep}})</option>
</template>

<template name="myIssueTmpl">
    <tr class="{{IPriorityText}}Priority">
        <td class="isTD" width="20px"><button class="delete" title="Delete this entry">&times;</button></td>
        <td class="isTD">{{IPriority}}-{{IPriorityText}}</td>
        <td class="isTD">{{TIssueName}}</td>
        <td class="isTD">{{CweId}}</td>
        <td class="isTD">{{TID}}</td>
        <td class="isTD">{{ICount}}</td>
        <td class="isTD">{{TSeverity}}-{{TSeverityText}}</td>
    </tr>
</template>

<template name="projectTmpl">
    <option value="{{name}}"></option>
</template>
